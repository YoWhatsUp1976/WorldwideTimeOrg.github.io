import React, { useState, useEffect } from 'react';
import { Clock, Globe, Info, AlertCircle, Calendar, Zap, Settings } from 'lucide-react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Switch } from '@/components/ui/switch';
import { Label } from '@/components/ui/label';
import { Badge } from '@/components/ui/badge';

export default function Home() {
  const [currentTime, setCurrentTime] = useState(new Date());
  const [selectedTimezone, setSelectedTimezone] = useState(Intl.DateTimeFormat().resolvedOptions().timeZone);
  const [is24Hour, setIs24Hour] = useState(true);

  const timezones = [
    'UTC',
    'America/New_York',
    'America/Chicago',
    'America/Denver',
    'America/Los_Angeles',
    'America/Anchorage',
    'Pacific/Honolulu',
    'America/Toronto',
    'America/Vancouver',
    'America/Mexico_City',
    'America/Sao_Paulo',
    'America/Buenos_Aires',
    'Europe/London',
    'Europe/Paris',
    'Europe/Berlin',
    'Europe/Madrid',
    'Europe/Rome',
    'Europe/Amsterdam',
    'Europe/Brussels',
    'Europe/Vienna',
    'Europe/Stockholm',
    'Europe/Oslo',
    'Europe/Copenhagen',
    'Europe/Helsinki',
    'Europe/Warsaw',
    'Europe/Prague',
    'Europe/Budapest',
    'Europe/Bucharest',
    'Europe/Athens',
    'Europe/Istanbul',
    'Europe/Moscow',
    'Africa/Cairo',
    'Africa/Johannesburg',
    'Africa/Nairobi',
    'Africa/Lagos',
    'Asia/Dubai',
    'Asia/Kolkata',
    'Asia/Shanghai',
    'Asia/Tokyo',
    'Asia/Seoul',
    'Asia/Hong_Kong',
    'Asia/Singapore',
    'Asia/Bangkok',
    'Asia/Jakarta',
    'Asia/Manila',
    'Asia/Taipei',
    'Australia/Sydney',
    'Australia/Melbourne',
    'Australia/Brisbane',
    'Australia/Perth',
    'Pacific/Auckland',
    'Pacific/Fiji',
  ].sort();

  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentTime(new Date());
    }, 1);

    return () => clearInterval(interval);
  }, []);

  const getTimeInTimezone = () => {
    return currentTime.toLocaleString('en-US', {
      timeZone: selectedTimezone,
      hour12: !is24Hour,
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
    });
  };

  const getDateInTimezone = () => {
    return currentTime.toLocaleString('en-US', {
      timeZone: selectedTimezone,
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    });
  };

  const getMilliseconds = () => {
    return currentTime.getMilliseconds().toString().padStart(3, '0');
  };

  const getUTCOffset = () => {
    const date = new Date(currentTime.toLocaleString('en-US', { timeZone: selectedTimezone }));
    const utcDate = new Date(currentTime.toLocaleString('en-US', { timeZone: 'UTC' }));
    const offset = (date.getTime() - utcDate.getTime()) / (1000 * 60 * 60);
    const sign = offset >= 0 ? '+' : '';
    return `UTC${sign}${offset}`;
  };

  const isLeapYear = (year) => {
    return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
  };

  const getNextLeapYear = () => {
    const currentYear = currentTime.getFullYear();
    let nextYear = currentYear + 1;
    while (!isLeapYear(nextYear)) {
      nextYear++;
    }
    return nextYear;
  };

  const getDaysUntilNextLeapYear = () => {
    const nextLeapYear = getNextLeapYear();
    const nextLeapYearDate = new Date(nextLeapYear, 0, 1);
    const diffTime = nextLeapYearDate - currentTime;
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    return diffDays;
  };

  const leapSeconds = [
    { date: '2017-01-01', description: 'Latest leap second added' },
    { date: '2015-07-01', description: 'Leap second added' },
    { date: '2012-07-01', description: 'Leap second added' },
    { date: '2009-01-01', description: 'Leap second added' },
    { date: '2006-01-01', description: 'Leap second added' },
  ];

  return (
    <div className="min-h-screen bg-black text-white">
      <header className="border-b border-gray-800 bg-gray-950">
        <div className="max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                <Clock className="w-6 h-6 text-black" />
              </div>
              <div>
                <h1 className="text-2xl font-bold tracking-tight">Worldwide Time Organization</h1>
                <p className="text-sm text-gray-500">Synchronized with Atomic Clocks</p>
              </div>
            </div>
            <Badge variant="outline" className="border-green-500 text-green-500 hidden sm:flex">
              <Zap className="w-3 h-3 mr-1" />
              LIVE
            </Badge>
          </div>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8">
        <Card className="border-2 border-gray-800 bg-gray-950 shadow-2xl mb-8">
          <CardContent className="p-6 sm:p-10">
            <div className="flex flex-col lg:flex-row items-center justify-between gap-4 mb-8">
              <div className="flex items-center gap-3 w-full lg:w-auto">
                <Globe className="w-5 h-5 text-gray-400" />
                <Select value={selectedTimezone} onValueChange={setSelectedTimezone}>
                  <SelectTrigger className="w-full lg:w-80 border-gray-700 bg-black text-white">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent className="max-h-80 bg-gray-950 border-gray-700">
                    {timezones.map((tz) => (
                      <SelectItem key={tz} value={tz} className="text-white">
                        {tz.replace(/_/g, ' ')}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
              </div>

              <div className="flex items-center gap-3">
                <Settings className="w-4 h-4 text-gray-400" />
                <Label htmlFor="time-format" className="text-gray-400">24H</Label>
                <Switch
                  id="time-format"
                  checked={is24Hour}
                  onCheckedChange={setIs24Hour}
                  className="data-[state=checked]:bg-white"
                />
              </div>
            </div>

            <div className="text-center mb-6">
              <div className="font-mono text-6xl sm:text-7xl md:text-8xl lg:text-9xl font-bold text-white mb-2 tracking-tighter">
                {getTimeInTimezone()}
                <span className="text-3xl sm:text-4xl md:text-5xl lg:text-6xl text-gray-500">
                  .{getMilliseconds()}
                </span>
              </div>
              <div className="text-lg sm:text-xl md:text-2xl text-gray-400 font-medium mt-4">
                {getDateInTimezone()}
              </div>
              <div className="text-base sm:text-lg text-gray-500 mt-2 font-mono">
                {getUTCOffset()}
              </div>
            </div>

            <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-8 pt-8 border-t border-gray-800">
              <div className="text-center">
                <div className="text-sm text-gray-500 uppercase tracking-wide mb-1">Timezone</div>
                <div className="text-base sm:text-lg font-semibold text-white">{selectedTimezone.replace(/_/g, ' ')}</div>
              </div>
              <div className="text-center">
                <div className="text-sm text-gray-500 uppercase tracking-wide mb-1">Precision</div>
                <div className="text-base sm:text-lg font-semibold text-white">±1 Millisecond</div>
              </div>
              <div className="text-center">
                <div className="text-sm text-gray-500 uppercase tracking-wide mb-1">Source</div>
                <div className="text-base sm:text-lg font-semibold text-white">Atomic Clock</div>
              </div>
            </div>
          </CardContent>
        </Card>

        <Tabs defaultValue="leap-years" className="w-full">
          <TabsList className="w-full bg-gray-950 border border-gray-800 grid grid-cols-2 lg:grid-cols-4 gap-2 p-2">
            <TabsTrigger value="leap-years" className="data-[state=active]:bg-white data-[state=active]:text-black">
              Leap Years
            </TabsTrigger>
            <TabsTrigger value="leap-seconds" className="data-[state=active]:bg-white data-[state=active]:text-black">
              Leap Seconds
            </TabsTrigger>
            <TabsTrigger value="standards" className="data-[state=active]:bg-white data-[state=active]:text-black">
              Standards
            </TabsTrigger>
            <TabsTrigger value="about" className="data-[state=active]:bg-white data-[state=active]:text-black">
              About
            </TabsTrigger>
          </TabsList>

          <TabsContent value="leap-years" className="mt-6">
            <div className="grid md:grid-cols-2 gap-6">
              <Card className="border-gray-800 bg-gray-950">
                <CardHeader>
                  <CardTitle className="flex items-center gap-2 text-white">
                    <Calendar className="w-5 h-5" />
                    Current Year Status
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-center">
                    <div className="text-5xl font-bold mb-2">
                      {currentTime.getFullYear()}
                    </div>
                    <Badge className={isLeapYear(currentTime.getFullYear()) ? "bg-green-500" : "bg-gray-700"}>
                      {isLeapYear(currentTime.getFullYear()) ? "IS A LEAP YEAR" : "NOT A LEAP YEAR"}
                    </Badge>
                    <p className="text-gray-400 mt-4 text-sm">
                      {isLeapYear(currentTime.getFullYear()) 
                        ? "This year has 366 days including February 29th"
                        : "This year has 365 days"}
                    </p>
                  </div>
                </CardContent>
              </Card>

              <Card className="border-gray-800 bg-gray-950">
                <CardHeader>
                  <CardTitle className="flex items-center gap-2 text-white">
                    <AlertCircle className="w-5 h-5" />
                    Next Leap Year
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-center">
                    <div className="text-5xl font-bold mb-2">
                      {getNextLeapYear()}
                    </div>
                    <Badge variant="outline" className="border-blue-500 text-blue-500">
                      IN {getDaysUntilNextLeapYear()} DAYS
                    </Badge>
                    <p className="text-gray-400 mt-4 text-sm">
                      The next leap year will add an extra day to February
                    </p>
                  </div>
                </CardContent>
              </Card>

              <Card className="border-gray-800 bg-gray-950 md:col-span-2">
                <CardHeader>
                  <CardTitle className="text-white">Leap Year Rules</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-3 text-gray-300">
                    <p className="flex items-start gap-2">
                      <span className="text-white font-bold">1.</span>
                      A year is a leap year if it is divisible by 4
                    </p>
                    <p className="flex items-start gap-2">
                      <span className="text-white font-bold">2.</span>
                      However, if the year is divisible by 100, it is NOT a leap year
                    </p>
                    <p className="flex items-start gap-2">
                      <span className="text-white font-bold">3.</span>
                      Unless the year is also divisible by 400, then it IS a leap year
                    </p>
                    <p className="text-sm text-gray-500 mt-4 italic">
                      Example: 2000 was a leap year (divisible by 400), but 1900 was not (divisible by 100 but not 400)
                    </p>
                  </div>
                </CardContent>
              </Card>
            </div>
          </TabsContent>

          <TabsContent value="leap-seconds" className="mt-6">
            <Card className="border-gray-800 bg-gray-950">
              <CardHeader>
                <CardTitle className="flex items-center gap-2 text-white">
                  <Zap className="w-5 h-5" />
                  Leap Second History
                </CardTitle>
              </CardHeader>
              <CardContent>
                <p className="text-gray-300 mb-6">
                  Leap seconds are occasional one-second adjustments added to Coordinated Universal Time (UTC) 
                  to keep it synchronized with astronomical time. They account for the irregular slowing of Earth's rotation.
                </p>
                <div className="space-y-4">
                  {leapSeconds.map((leap, index) => (
                    <div key={index} className="flex items-center justify-between p-4 border border-gray-800 rounded-lg bg-black">
                      <div>
                        <div className="font-semibold text-white">{leap.date}</div>
                        <div className="text-sm text-gray-400">{leap.description}</div>
                      </div>
                      <Badge variant="outline" className="border-yellow-500 text-yellow-500">
                        +1s
                      </Badge>
                    </div>
                  ))}
                </div>
                <div className="mt-6 p-4 bg-black border border-gray-800 rounded-lg">
                  <h4 className="font-semibold text-white mb-2">Key Facts</h4>
                  <ul className="space-y-2 text-sm text-gray-300">
                    <li>• Total of 27 leap seconds have been added since 1972</li>
                    <li>• The last leap second was added on December 31, 2016</li>
                    <li>• Leap seconds are announced by the IERS (International Earth Rotation Service)</li>
                    <li>• Our atomic clocks automatically account for leap seconds</li>
                  </ul>
                </div>
              </CardContent>
            </Card>
          </TabsContent>

          <TabsContent value="standards" className="mt-6">
            <div className="grid md:grid-cols-2 gap-6">
              <Card className="border-gray-800 bg-gray-950">
                <CardHeader>
                  <CardTitle className="text-white">UTC (Coordinated Universal Time)</CardTitle>
                </CardHeader>
                <CardContent className="text-gray-300 space-y-3">
                  <p>The primary time standard by which the world regulates clocks and time.</p>
                  <ul className="space-y-2 text-sm">
                    <li>• Based on International Atomic Time (TAI)</li>
                    <li>• Adjusted with leap seconds</li>
                    <li>• Used as the basis for all timezones</li>
                    <li>• Maintained by atomic clocks worldwide</li>
                  </ul>
                </CardContent>
              </Card>

              <Card className="border-gray-800 bg-gray-950">
                <CardHeader>
                  <CardTitle className="text-white">Atomic Clock Accuracy</CardTitle>
                </CardHeader>
                <CardContent className="text-gray-300 space-y-3">
                  <p>The most accurate timekeeping devices ever created.</p>
                  <ul className="space-y-2 text-sm">
                    <li>• Accurate to within 1 second per 100 million years</li>
                    <li>• Based on cesium-133 atom oscillations</li>
                    <li>• Defines the international second</li>
                    <li>• Used in GPS, telecommunications, and science</li>
                  </ul>
                </CardContent>
              </Card>

              <Card className="border-gray-800 bg-gray-950 md:col-span-2">
                <CardHeader>
                  <CardTitle className="text-white">Global Timekeeping Network</CardTitle>
                </CardHeader>
                <CardContent className="text-gray-300">
                  <p className="mb-4">
                    Our system synchronizes with the international network of atomic clocks operated by:
                  </p>
                  <div className="grid sm:grid-cols-2 gap-4">
                    <div className="p-3 bg-black border border-gray-800 rounded-lg">
                      <div className="font-semibold text-white mb-1">NIST (USA)</div>
                      <div className="text-sm text-gray-400">National Institute of Standards and Technology</div>
                    </div>
                    <div className="p-3 bg-black border border-gray-800 rounded-lg">
                      <div className="font-semibold text-white mb-1">BIPM (France)</div>
                      <div className="text-sm text-gray-400">International Bureau of Weights and Measures</div>
                    </div>
                    <div className="p-3 bg-black border border-gray-800 rounded-lg">
                      <div className="font-semibold text-white mb-1">PTB (Germany)</div>
                      <div className="text-sm text-gray-400">Physikalisch-Technische Bundesanstalt</div>
                    </div>
                    <div className="p-3 bg-black border border-gray-800 rounded-lg">
                      <div className="font-semibold text-white mb-1">NICT (Japan)</div>
                      <div className="text-sm text-gray-400">National Institute of Information and Communications</div>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </div>
          </TabsContent>

          <TabsContent value="about" className="mt-6">
            <Card className="border-gray-800 bg-gray-950">
              <CardContent className="p-8 sm:p-12">
                <div className="text-center mb-8">
                  <Info className="w-16 h-16 mx-auto mb-4 text-white" />
                  <h3 className="text-3xl font-bold mb-4 text-white">Our Mission</h3>
                  <p className="text-lg text-gray-300 max-w-3xl mx-auto leading-relaxed">
                    The Worldwide Time Organization is dedicated to providing the most accurate and accessible
                    time information to people around the globe. We believe that precise timekeeping is
                    fundamental to modern life, enabling coordination, synchronization, and punctuality
                    across all human endeavors.
                  </p>
                </div>

                <div className="grid md:grid-cols-2 gap-6 mt-8">
                  <div className="p-6 bg-black border border-gray-800 rounded-lg">
                    <Clock className="w-8 h-8 mb-3 text-white" />
                    <h4 className="text-xl font-bold mb-2 text-white">Millisecond Precision</h4>
                    <p className="text-gray-400">
                      Our clocks display time down to the millisecond, synchronized with atomic clocks
                      for unparalleled accuracy in all your timekeeping needs.
                    </p>
                  </div>

                  <div className="p-6 bg-black border border-gray-800 rounded-lg">
                    <Globe className="w-8 h-8 mb-3 text-white" />
                    <h4 className="text-xl font-bold mb-2 text-white">Global Coverage</h4>
                    <p className="text-gray-400">
                      Access precise time information for every major timezone across the globe,
                      from New York to Tokyo and everywhere in between.
                    </p>
                  </div>
                </div>
              </CardContent>
            </Card>
          </TabsContent>
        </Tabs>
      </main>

      <footer className="border-t border-gray-800 bg-gray-950 mt-20">
        <div className="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8">
          <div className="text-center text-gray-400">
            <p className="font-semibold text-white mb-2">Worldwide Time Organization</p>
            <p className="text-sm">© 2025 All rights reserved. Keeping time for the world.</p>
          </div>
        </div>
      </footer>
    </div>
  );
}
